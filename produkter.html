<!doctype html>
<html lang="sv"><head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
<link rel="stylesheet" href="semantic/semantic.min.css" />
<link rel="stylesheet" href="styles/main.css" />
<script src="scripts/jquery-3.2.1.min.js"></script>
<script src="semantic/semantic.min.js"></script>
<script src="scripts/main.js"></script>
<title> - TechStore</title>
<script>
    var categories = [];
    var subcategories = [];
    var initJSONS = function() {
        if(localStorage.categories) {
            categories = JSON.parse(localStorage.categories);
            getSubcategories();
            
        } else $.getJSON('http://farochmehri.wieg17.se/webshop/jsons/huvudkategorier.json', function(data){
            categories = data;
            localStorage.categories = JSON.stringify(categories);
            getSubcategories();
        });
    };
    
    var getSubcategories = function() {
        if(localStorage.subcategories) {
            subcategories = JSON.parse(localStorage.subcategories);
            updatePage();
            
        } else $.getJSON('http://farochmehri.wieg17.se/webshop/jsons/underkategorier.json', function(data){
            subcategories = data;
            localStorage.subcategories = JSON.stringify(subcategories);
            updatePage();
        });
    };
    
    var updatePage = function() {
        var items = [], actNAM; 
        var PGID = location.search.substr(1).split('=');
        if(PGID[0] == 'subid') {
            var topCAT = {};
            for(var value of products) { if(value.underKat == PGID[1]) items.push(value); }            
            for(var value of subcategories) { if(value.id == PGID[1]) { topCAT.id = value.huvudkategori; actNAM = value.name; break; } }
            for(var value of categories) { if(value.id == topCAT.id) { topCAT.name = value.name; break; } }
            $('.breadcrumb').append('<a class="section" href="produkter.html?catid='+topCAT.id+'">'+topCAT.name+'</a><i class="right angle icon divider"></i>');
            $('.breadcrumb').append('<div class="active section">'+actNAM+'</div>');
            document.title = topCAT.name +' ('+ actNAM +') '+ document.title;
            
        } else {
            for(var value of products) { if(value.huvudKat == PGID[1]) items.push(value); }
            for(var value of categories) { if(value.id == PGID[1]) { actNAM = value.name; break; } }
            $('.breadcrumb').append('<div class="active section">'+actNAM+'</div>');
            document.title = actNAM +' '+ document.title;
        }
        if(typeof(actNAM) == 'undefined') window.location = 'index.html';
        
        var html = '';
        $('#catname').text(document.title);
        for(var value of items) {
            html += '<div class="column"><div class="ui card">';
            html += '<a class="image" href="produkt.html?id='+value.id+'">';
            html += '<img src="images/'+value.id+'.jpg" /></a><div class="content">';
            html += '<div class="extra content"><span>'+value.prodPrice+' kr</span>';
            html += '<button onclick="addCart('+value.id+')" class="ui icon button right floated green">';
            html += '<i class="icon add to cart"></i></button></div><a class="header" href="produkt.html?id=';
            html += value.id+'">'+value.prodName+'</a></div></div></div>';
        }
        $('.products').html(html);
    };
</script>
</head>
<body class="pushable">
    <!-- Left Sidebar -->
    <div class="ui inverted left vertical sidebar menu">
        <div class="mdiv"></div><ul class="ul"></ul>
    </div>

    <!-- Top Fixed Menu  menu-trigger-->
    <div class="ui top fixed menu">
        <div class="ui container">
            <a class="item meny"><i class="sidebar icon"></i><span>Meny</span></a>
            <a class="item logo" href="index.html">TechStore</a>
            <div class="ui dropdown link item">
                <i class="grid layout icon"></i>
                <span class="text">Produkter</span>
                <div class="menu"></div>
            </div>
            <a id="omoss" href="omoss.html" class="ui item"><i class="info circle icon"></i><span>Om oss</span></a>
            <a id="kontaktaoss" href="kontakt.html" class="ui item"><i class="linkify icon"></i><span>Kontakta oss</span></a>
            <a id="kundvagn" class="ui item"><i class="in cart icon"></i><span></span></a>
            <a id="signIO" class="ui item"></a>
        </div>
    </div>

    <div class="pusher">
        <!-- Page Content Here-->
        <div class="mdiv"></div>
        <div class="ui container">
            <div class="one wide row">
                <div class="ui breadcrumb">
                    <a class="section" href="index.html">Hem</a><i class="right angle icon divider"></i>
                </div>
                <h2 id="catname" class="center"></h2>
            </div>
            <div class="ui basic segment">
                <div class="ui stackable three column grid products"></div>
            </div>
        </div>
    
        <!-- Footer -->
        <div class="ui inverted vertical footer segment">
            <div class="ui container">
                <div class="ui stackable inverted divided equal height grid">
                    <div class="eight wide column">
                        <h4 class="ui inverted header">Kontaktinformation</h4>
                        <div class="ui inverted link list">
                            <span>TechStore</span><br />
                            <span>Halvsekelsgatan 7</span><br />
                            <span>41508 GÃ¶teborg</span><br /><br />
                            <span>E-post: kontakt@techstore.se</span><br />
                            <span>Telefon: 070 00 00 00</span>
                        </div>
                    </div>
                    <div class="eight wide column">
                        <h4 class="ui inverted header"></h4>
                        <div class="ui inverted link list block">
                            <a href="kontakt.html" class="item"><i class="chevron right icon"></i> Kontakta oss</a>
                            <a href="konto.html" class="item"><i class="chevron right icon"></i> Skapa konto</a>
                            <a href="omoss.html" class="item"><i class="chevron right icon"></i> Om oss</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>